{"ast":null,"code":"import Tone from 'tone';\nconsole.clear(); // UPDATE: there is a problem in chrome with starting audio context\n//  before a user gesture. This fixes it.\n\ndocument.documentElement.addEventListener('mousedown', function () {\n  if (Tone.context.state !== 'running') Tone.context.resume();\n});\nvar synths = [new Tone.Synth(), new Tone.Synth(), new Tone.Synth()];\nsynths[0].oscillator.type = 'triangle';\nsynths[1].oscillator.type = 'sine';\nsynths[2].oscillator.type = 'sawtooth';\nvar gain = new Tone.Gain(0.6);\ngain.toMaster();\nsynths.forEach(function (synth) {\n  return synth.connect(gain);\n});\nvar $rows = document.body.querySelectorAll('.checkbox > .check'),\n    notes = ['G5', 'E4', 'C3'];\nvar index = 0;\nTone.Transport.scheduleRepeat(repeat, '8n');\nTone.Transport.start();\n\nfunction repeat(time) {\n  var step = index % 8;\n\n  for (var i = 0; i < $rows.length; i++) {\n    var synth = synths[i],\n        note = notes[i],\n        $row = $rows[i],\n        $input = $row.querySelector(\"input:nth-child(\".concat(step + 1, \")\"));\n    if ($input.checked) synth.triggerAttackRelease(note, '8n', time);\n  }\n\n  index++;\n}","map":{"version":3,"sources":["/Users/martsofi/DZmusic/app/javascript/sequence.js"],"names":["Tone","console","clear","document","documentElement","addEventListener","context","state","resume","synths","Synth","oscillator","type","gain","Gain","toMaster","forEach","synth","connect","$rows","body","querySelectorAll","notes","index","Transport","scheduleRepeat","repeat","start","time","step","i","length","note","$row","$input","querySelector","checked","triggerAttackRelease"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,MAAjB;AAEAC,OAAO,CAACC,KAAR,G,CAEA;AACA;;AACAC,QAAQ,CAACC,eAAT,CAAyBC,gBAAzB,CAA0C,WAA1C,EAAuD,YAAM;AAC3D,MAAIL,IAAI,CAACM,OAAL,CAAaC,KAAb,KAAuB,SAA3B,EAAsCP,IAAI,CAACM,OAAL,CAAaE,MAAb;AACvC,CAFD;AAIA,IAAMC,MAAM,GAAG,CAAC,IAAIT,IAAI,CAACU,KAAT,EAAD,EAAmB,IAAIV,IAAI,CAACU,KAAT,EAAnB,EAAqC,IAAIV,IAAI,CAACU,KAAT,EAArC,CAAf;AAEAD,MAAM,CAAC,CAAD,CAAN,CAAUE,UAAV,CAAqBC,IAArB,GAA4B,UAA5B;AACAH,MAAM,CAAC,CAAD,CAAN,CAAUE,UAAV,CAAqBC,IAArB,GAA4B,MAA5B;AACAH,MAAM,CAAC,CAAD,CAAN,CAAUE,UAAV,CAAqBC,IAArB,GAA4B,UAA5B;AAEA,IAAMC,IAAI,GAAG,IAAIb,IAAI,CAACc,IAAT,CAAc,GAAd,CAAb;AACAD,IAAI,CAACE,QAAL;AAEAN,MAAM,CAACO,OAAP,CAAe,UAAAC,KAAK;AAAA,SAAIA,KAAK,CAACC,OAAN,CAAcL,IAAd,CAAJ;AAAA,CAApB;AAEA,IAAMM,KAAK,GAAGhB,QAAQ,CAACiB,IAAT,CAAcC,gBAAd,CAA+B,oBAA/B,CAAd;AAAA,IACEC,KAAK,GAAG,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CADV;AAEA,IAAIC,KAAK,GAAG,CAAZ;AAEAvB,IAAI,CAACwB,SAAL,CAAeC,cAAf,CAA8BC,MAA9B,EAAsC,IAAtC;AACA1B,IAAI,CAACwB,SAAL,CAAeG,KAAf;;AAEA,SAASD,MAAT,CAAgBE,IAAhB,EAAsB;AACpB,MAAIC,IAAI,GAAGN,KAAK,GAAG,CAAnB;;AACA,OAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGX,KAAK,CAACY,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;AACrC,QAAIb,KAAK,GAAGR,MAAM,CAACqB,CAAD,CAAlB;AAAA,QACEE,IAAI,GAAGV,KAAK,CAACQ,CAAD,CADd;AAAA,QAEEG,IAAI,GAAGd,KAAK,CAACW,CAAD,CAFd;AAAA,QAGEI,MAAM,GAAGD,IAAI,CAACE,aAAL,2BAAsCN,IAAI,GAAG,CAA7C,OAHX;AAIA,QAAIK,MAAM,CAACE,OAAX,EAAoBnB,KAAK,CAACoB,oBAAN,CAA2BL,IAA3B,EAAiC,IAAjC,EAAuCJ,IAAvC;AACrB;;AACDL,EAAAA,KAAK;AACN","sourcesContent":["import Tone from 'tone'\n\nconsole.clear()\n\n// UPDATE: there is a problem in chrome with starting audio context\n//  before a user gesture. This fixes it.\ndocument.documentElement.addEventListener('mousedown', () => {\n  if (Tone.context.state !== 'running') Tone.context.resume()\n})\n\nconst synths = [new Tone.Synth(), new Tone.Synth(), new Tone.Synth()]\n\nsynths[0].oscillator.type = 'triangle'\nsynths[1].oscillator.type = 'sine'\nsynths[2].oscillator.type = 'sawtooth'\n\nconst gain = new Tone.Gain(0.6)\ngain.toMaster()\n\nsynths.forEach(synth => synth.connect(gain))\n\nconst $rows = document.body.querySelectorAll('.checkbox > .check'),\n  notes = ['G5', 'E4', 'C3']\nlet index = 0\n\nTone.Transport.scheduleRepeat(repeat, '8n')\nTone.Transport.start()\n\nfunction repeat(time) {\n  let step = index % 8\n  for (let i = 0; i < $rows.length; i++) {\n    let synth = synths[i],\n      note = notes[i],\n      $row = $rows[i],\n      $input = $row.querySelector(`input:nth-child(${step + 1})`)\n    if ($input.checked) synth.triggerAttackRelease(note, '8n', time)\n  }\n  index++\n}\n"]},"metadata":{},"sourceType":"module"}